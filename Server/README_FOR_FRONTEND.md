README - Form definition and backend contract (for frontend)

Purpose

This document explains how the frontend should render and send clinical form data to the backend in this project. It includes:
- A plain description of the contract the backend expects
- A minimal JSON schema for the "form definition" file the frontend can use
- Example payloads to POST to /api/anamnesis
- A small QA checklist


1) Backend contract (what the backend expects)

Endpoint: POST /api/anamnesis
Body JSON:
{
  "patientID": "<string - consultation id>",
  "answers": [
    { "key": "<field_id>", "type": "text|boolean|single|multi|number|date", "value": <value> },
    ...
  ]
}

Notes:
- keys must be stable and unique (e.g. "inicioCuadro_fecha_inicio").
- value must match type: for type="multi" value must be an array of strings; for type="boolean" a boolean or null; for type="number" a number; for type="date" an ISO date string; for type="text" a string.
- If no answer, send value: null (or [] for multi) to explicitly mark "no response".


2) Minimal form-definition JSON (what the frontend should load/render)

This is a minimal example that your frontend can consume to render the UI.

Example `form-definition.json` structure:
{
  "schemaVersion": "1.0",
  "id": "consultation_v1",
  "title": "Consulta clínica general",
  "sections": [
    {
      "id": "inicioCuadro",
      "title": "Inicio del cuadro",
      "fields": [
        {
          "id": "inicioCuadro_fecha_inicio",
          "label": "¿Cuándo comenzó el problema?",
          "type": "date",
          "widget": "datetime",
          "required": false,
          "hint": "Fecha y hora si es agudo"
        },
        {
          "id": "inicioCuadro_tipo_inicio",
          "label": "¿Cómo fue el inicio?",
          "type": "single",
          "widget": "radio",
          "options": ["brusco","gradual"],
          "required": false
        }
      ]
    }
  ]
}

You can extend the `fields` entries with:
- maxLength, validators (regex), placeholder
- visibleIf: conditional visibility based on other values
- i18n keys if you manage multiple languages


3) Full example: 1 section (inicioCuadro) + POST payload

Frontend form-definition (snippet)
{
  "id": "inicioCuadro",
  "title": "Inicio del cuadro",
  "fields": [
    { "id": "inicioCuadro_fecha_inicio", "label": "¿Cuándo comenzó el problema?", "type": "date", "widget": "datetime", "required": false },
    { "id": "inicioCuadro_tipo_inicio", "label": "¿Cómo fue el inicio?", "type": "single", "widget": "radio", "options": ["brusco","gradual"] }
  ]
}

Payload to POST (example)
{
  "patientID": "aecf694e-d891-4f53-a064-38cb0c9b97a2",
  "answers": [
    { "key": "inicioCuadro_fecha_inicio", "type": "date", "value": "2025-10-14" },
    { "key": "inicioCuadro_tipo_inicio", "type": "single", "value": "brusco" }
  ]
}


4) Example: empty payload (user skipped answers)
{
  "patientID": "aecf694e-d891-4f53-a064-38cb0c9b97a2",
  "answers": [
    { "key": "inicioCuadro_fecha_inicio", "type": "date", "value": null },
    { "key": "inicioCuadro_tipo_inicio", "type": "single", "value": null }
  ]
}


6) QA checklist (frontend ↔ backend)
- [ ] Form definition loaded and sections rendered with correct labels
- [ ] Each field's `id` used as `key` in the payload
- [ ] Values mapped to backend types as specified
- [ ] Empty/unanswered fields are sent as null (or [] for multi)
- [ ] POST /api/anamnesis returns 200 and partialState includes sent keys
- [ ] Test one example with real patientID that was created with POST /start
- [ ] Test invalid types (send string where number expected) and confirm backend returns 400 (or handles gracefully)
- [ ] Version the form-definition and test backward compatibility


7) How to test in Swagger
- Open Swagger UI on /docs
- Find POST /api/anamnesis
- Paste example payload into the body
- Send request and confirm response contains updated `partialState` or expected fields


8) Next steps for integration
- Provide the frontend team the `form-definition.json` (or a few JSON examples) and this README
- Agree on naming conventions for keys (use consistent camelCase or snake_case)
- Decide how to host the form-definition: frontend repo, CDN, or endpoint
- Add basic validation in backend if stricter guarantees are needed


---
Generated by the dev team helper. If you want the full `form-definition.json` (complete, covering all 10 sections with the precise fields you listed), say "sí, genera el archivo completo" and lo creo ahora.

## Complete question list (exact order you provided) with backend types

Below is the precise list of questions you sent, kept in the same order, with a recommended `key` (id) and the backend `type` that the frontend must send in the `answers` array. Types must be one of: `text`, `date`, `single`, `multi`, `boolean`, `number`.

1) INICIO DEL CUADRO
  - ¿Cuándo comenzó el problema? (fecha y hora específica si es agudo)
    - key: `inicioCuadro_fecha_inicio`
    - type: `date` (ISO date or datetime string)
  - ¿Cómo fue el inicio: brusco o gradual?
    - key: `inicioCuadro_tipo_inicio`
    - type: `single` (options: `brusco`, `gradual`)
  - ¿Hace cuánto tiempo presenta los síntomas? (horas / días / semanas / meses / años)
    - key: `inicioCuadro_tiempo_presenta`
    - type: `text` (free text like "2 días", or you can map to number+unit if you prefer)
  - ¿Hubo algún evento desencadenante? (esfuerzo, comida, estrés, traumatismo)
    - key: `inicioCuadro_evento_desencadenante`
    - type: `multi` (array of strings; allowed values: `esfuerzo`,`comida`,`estres`,`traumatismo`)

2) EVOLUCIÓN Y PATRÓN TEMPORAL
  - ¿Cómo ha evolucionado desde que comenzó? (progresivo / estable / intermitente / en mejoría / en empeoramiento)
    - key: `evolucion_como`
    - type: `single` (options as listed)
  - ¿Es continuo o tiene períodos de remisión?
    - key: `evolucion_remision`
    - type: `text` (free text for the specialist to describe)
  - ¿Hay un patrón horario? (matutino, vespertino, nocturno)
    - key: `patron_horario`
    - type: `single` (options: `matutino`,`vespertino`,`nocturno`)
  - ¿Ha recibido algún tratamiento? ¿Mejoró, empeoró o no hubo cambios?
    - key: `evolucion_tratamiento_resultado`
    - type: `single` (options: `mejoro`,`empeoro`,`sin_cambios`)

3) LOCALIZACIÓN Y CARACTERÍSTICAS ESPACIALES
  - ¿Dónde siente el síntoma principal? (señalar con el dedo si es dolor)
    - key: `localizacion_principal`
    - type: `text`
  - ¿Se irradia hacia algún otro lugar? ¿Hacia dónde?
    - key: `localizacion_irradia`
    - type: `boolean` (true/false for "irradiates")
    - key: `localizacion_irradia_hacia`
    - type: `text` (only filled when previous is true)
  - ¿Es siempre en el mismo sitio o cambia de localización?
    - key: `localizacion_variacion`
    - type: `text`
  - ¿Es focal (puntual) o difuso?
    - key: `tipo_localizacion`
    - type: `single` (options: `focal`,`difuso`)

4) CARACTERÍSTICAS DEL SÍNTOMA (especialmente si es DOLOR)
  - ¿Cómo lo describiría? (punzante / opresivo / cólico / urente / pulsátil / difuso / lancinante)
    - key: `caracteristicas_tipo`
    - type: `single` (one of the 7 options)
  - ¿Qué intensidad tiene en una escala del 1 al 10?
    - key: `caracteristicas_intensidad`
    - type: `number` (1-10)
  - ¿Cuánto dura cada episodio? (segundos / minutos / horas / constante)
    - key: `caracteristicas_duracion_episodio`
    - type: `text`
  - ¿Qué lo alivia? (reposo, posición, medicación, comida, no se alivia)
    - key: `caracteristicas_que_alivia`
    - type: `multi` (array of strings)
  - ¿Qué lo empeora? (movimiento, respiración, comida, esfuerzo, estrés)
    - key: `caracteristicas_que_empeora`
    - type: `multi`

5) SÍNTOMAS ASOCIADOS (revisar por sistemas)
  - Generales (preguntas múltiples: fiebre, escalofríos, astenia, pérdida de peso, sudoración nocturna)
    - key: `sintomas_generales`
    - type: `multi` (values: `fiebre`,`escalofrios`,`astenia`,`perdida_peso`,`sudoracion_nocturna`)
  - Cardiovascular (palpitaciones, dolor torácico, disnea, edemas piernas, ninguno)
    - key: `sintomas_cardiovascular`
    - type: `multi` (or `single` with `ninguno`, but `multi` is more flexible)
  - Respiratorio (tos, expectoración, disnea, dolor torácico respiratorio)
    - key: `sintomas_respiratorio`
    - type: `multi`
  - Digestivo (náuseas, vómitos, diarrea, constipación, dolor abdominal)
    - key: `sintomas_digestivo`
    - type: `multi`
  - Urinario (disuria, polaquiuria, hematuria, cambios color orina, sin cambios)
    - key: `sintomas_urinario`
    - type: `multi`
  - Neurológico (cefalea, mareos, vértigo, alteraciones visuales, parestesias)
    - key: `sintomas_neurologico`
    - type: `multi`
  - Otros: especificar según motivo
    - key: `sintomas_otros_detalle`
    - type: `text`

6) FACTORES DESENCADENANTES Y CONTEXTO
  - ¿Hubo algún factor que precipitó los síntomas? (lista)
    - key: `factores_desencadenantes`
    - type: `multi` (values: `traumatismo`,`ejercicio`,`alimento_especifico`,`medicamento_nuevo`,`estres_emocional`,`exposicion_ambiental`,`picadura_insecto`)
  - ¿Se relaciona con alguna actividad específica? (si no, cuál)
    - key: `factores_actividad_relacionada`
    - type: `text`
  - ¿Varía con el momento del día? (si no, cuál)
    - key: `factores_varia_momento_dia`
    - type: `text`
  - ¿Varía con las comidas? (si no, cuál)
    - key: `factores_varia_comidas`
    - type: `text`

7) ANTECEDENTES RECIENTES Y CONTACTOS
  - ¿Alguien cercano presentó síntomas similares?
    - key: `antecedentes_contactos_similares`
    - type: `boolean`
  - Si sí, quién / contexto
    - key: `antecedentes_contactos_detalle`
    - type: `text`
  - ¿Ha tenido cuadros parecidos antes? Si no, cuándo y cómo se resolvieron
    - key: `antecedentes_previos`
    - type: `text`
  - ¿Tuvo infecciones recientes? (respiratoria, urinaria, gastrointestinal)
    - key: `antecedentes_infecciones_recientes`
    - type: `multi`
  - ¿Ha viajado recientemente? ¿A dónde?
    - key: `antecedentes_viajes_destino`
    - type: `text`
  - ¿Exposición a mosquitos?
    - key: `antecedentes_exposicion_mosquitos`
    - type: `boolean`
  - ¿Contacto con animales?
    - key: `antecedentes_contacto_animales`
    - type: `boolean`
    - key: `antecedentes_contacto_animales_detalle`
    - type: `text`

8) REPERCUSIÓN FUNCIONAL Y CALIDAD DE VIDA
  - ¿Le impide realizar sus actividades habituales?
    - key: `repercusiones_actividades`
    - type: `boolean`
  - ¿Tuvo que quedarse en cama o faltar al trabajo/estudio?
    - key: `repercusiones_ausencia_trabajo`
    - type: `boolean`
  - ¿Ha afectado su sueño?
    - key: `repercusiones_sueno`
    - type: `boolean`
  - ¿Ha afectado su apetito?
    - key: `repercusiones_apetito`
    - type: `boolean`
  - ¿Ha afectado su estado de ánimo?
    - key: `repercusiones_estado_animo`
    - type: `boolean`

9) TRATAMIENTOS PREVIOS Y AUTOMEDICACIÓN
  - ¿Tomó alguna medicación para aliviarlo? ¿Cuál? ¿Dosis?
    - key: `tratamientos_previos_medicacion`
    - type: `text` (or `multi` if you want several entries)
  - ¿Le hizo efecto? ¿Cuánto tiempo después?
    - key: `tratamientos_previos_resultado`
    - type: `text`
  - ¿Recibió atención médica antes de esta consulta? ¿Dónde?
    - key: `tratamientos_previos_atencion_previa`
    - type: `text`
  - ¿Le indicaron estudios? ¿Tiene los resultados?
    - key: `tratamientos_previos_estudios`
    - type: `text`
  - ¿Usa remedios caseros o medicina alternativa?
    - key: `tratamientos_previos_remedios_caseros`
    - type: `text`

10) SÍNTOMAS DE ALARMA (Red Flags)
  - Fiebre alta persistente (>38.5°C por más de 3 días) - días de fiebre
    - key: `redflags_fiebre_dias`
    - type: `number` (days)
  - Sangrados (hemoptisis, hematemesis, melena, hematuria, hemorragia)
    - key: `redflags_sangrados`
    - type: `multi` (list bleeding types)
  - Dificultad respiratoria severa o disnea de reposo
    - key: `redflags_disnea_severa`
    - type: `boolean`
  - Dolor torácico intenso, opresivo, con irradiación
    - key: `redflags_dolor_toracico`
    - type: `boolean`
    - key: `redflags_dolor_toracico_irradia`
    - type: `text`
  - Pérdida de peso no intencional significativa (>5% en 1 mes)
    - key: `redflags_perdida_peso`
    - type: `boolean`
  - Pérdida de conciencia, síncope, lipotimia
    - key: `redflags_sincope`
    - type: `boolean`
  - Convulsiones
    - key: `redflags_convulsiones`
    - type: `boolean`
  - Alteraciones neurológicas agudas (paresia, parestesias, afasia, alteración visual súbita)
    - key: `redflags_neurologico`
    - type: `multi`
  - Deshidratación severa (en contexto de vómitos/diarrea)
    - key: `redflags_deshidratacion`
    - type: `text` (clinical detail)
  - Ictericia (piel/ojos amarillos)
    - key: `redflags_ictericia`
    - type: `boolean`
  - Signos de sangrado activo o petequias (considerar dengue)
    - key: `redflags_petequias`
    - type: `boolean`

Special considerations for Uruguay: these should be included as fields (boolean/text) and shown conditionally by the frontend when relevant (season, travel, rural exposure, livestock contact).

---
This complete mapping is intended to be copy-pasted by the frontend team as the authoritative field list. The frontend must convert UI answers into the `{key,type,value}` structure before POSTing to `/api/anamnesis`.

form definition.json:
{
  "schemaVersion": "1.0",
  "id": "consultation_full_v1",
  "title": "Formulario clínico completo (Uruguay)",
  "locale": "es-UY",
  "sections": [
    {
      "id": "inicioCuadro",
      "title": "Inicio del cuadro",
      "fields": [
        {
          "id": "inicioCuadro_fecha_inicio",
          "label": "¿Cuándo comenzó el problema? (fecha y hora si es agudo)",
          "type": "date",
          "widget": "datetime",
          "required": false,
          "hint": "Fecha y hora preferible en ISO8601"
        },
        {
          "id": "inicioCuadro_tipo_inicio",
          "label": "¿Cómo fue el inicio?",
          "type": "single",
          "widget": "radio",
          "options": ["brusco", "gradual"],
          "required": false
        },
        {
          "id": "inicioCuadro_tiempo_presenta",
          "label": "¿Hace cuánto tiempo presenta los síntomas? (horas / días / semanas / meses / años)",
          "type": "text",
          "widget": "text",
          "required": false,
          "hint": "Ej: '2 días', '3 semanas'"
        },
        {
          "id": "inicioCuadro_evento_desencadenante",
          "label": "¿Hubo algún evento desencadenante?",
          "type": "multi",
          "widget": "checkbox",
          "options": ["esfuerzo", "comida", "estrés", "traumatismo", "otro"],
          "required": false
        }
      ]
    },
    {
      "id": "evolucion",
      "title": "Evolución y patrón temporal",
      "fields": [
        {
          "id": "evolucion_como",
          "label": "¿Cómo ha evolucionado desde que comenzó?",
          "type": "single",
          "widget": "radio",
          "options": ["progresivo", "estable", "intermitente", "en mejoría", "en empeoramiento"],
          "required": false
        },
        {
          "id": "evolucion_remision",
          "label": "¿Es continuo o tiene períodos de remisión?",
          "type": "text",
          "widget": "text",
          "required": false,
          "hint": "Describa si hay remisiones y su duración"
        },
        {
          "id": "patron_horario",
          "label": "¿Hay un patrón horario?",
          "type": "single",
          "widget": "radio",
          "options": ["matutino", "vespertino", "nocturno"],
          "required": false
        },
        {
          "id": "evolucion_tratamiento_resultado",
          "label": "¿Ha recibido algún tratamiento? (mejoró / empeoró / sin cambios)",
          "type": "single",
          "widget": "radio",
          "options": ["mejoró", "empeoró", "sin cambios"],
          "required": false
        }
      ]
    },
    {
      "id": "localizacion",
      "title": "Localización y características espaciales",
      "fields": [
        {
          "id": "localizacion_principal",
          "label": "¿Dónde siente el síntoma principal?",
          "type": "text",
          "widget": "text",
          "required": false,
          "hint": "Indicar ubicación exacta (señalar con el dedo si es dolor)"
        },
        {
          "id": "localizacion_irradia",
          "label": "¿Se irradia hacia algún otro lugar?",
          "type": "boolean",
          "widget": "toggle",
          "required": false
        },
        {
          "id": "localizacion_irradia_hacia",
          "label": "Si irradia, ¿hacia dónde?",
          "type": "text",
          "widget": "text",
          "required": false,
          "visibleIf": { "localizacion_irradia": true }
        },
        {
          "id": "localizacion_variacion",
          "label": "¿Es siempre en el mismo sitio o cambia de localización?",
          "type": "text",
          "widget": "text",
          "required": false
        },
        {
          "id": "tipo_localizacion",
          "label": "¿Es focal (puntual) o difuso?",
          "type": "single",
          "widget": "radio",
          "options": ["focal", "difuso"],
          "required": false
        }
      ]
    },
    {
      "id": "caracteristicas",
      "title": "Características del síntoma (especialmente dolor)",
      "fields": [
        {
          "id": "caracteristicas_tipo",
          "label": "¿Cómo lo describiría?",
          "type": "single",
          "widget": "select",
          "options": ["punzante", "opresivo", "cólico", "urente", "pulsátil", "difuso", "lancinante"],
          "required": false
        },
        {
          "id": "caracteristicas_intensidad",
          "label": "¿Qué intensidad tiene en una escala del 1 al 10?",
          "type": "number",
          "widget": "number",
          "required": false,
          "hint": "1 = mínimo, 10 = máximo"
        },
        {
          "id": "caracteristicas_duracion_episodio",
          "label": "¿Cuánto dura cada episodio?",
          "type": "text",
          "widget": "text",
          "required": false,
          "hint": "Segundos / minutos / horas / constante"
        },
        {
          "id": "caracteristicas_que_alivia",
          "label": "¿Qué lo alivia?",
          "type": "multi",
          "widget": "checkbox",
          "options": ["reposo", "posición", "medicación", "comida", "no se alivia"],
          "required": false
        },
        {
          "id": "caracteristicas_que_empeora",
          "label": "¿Qué lo empeora?",
          "type": "multi",
          "widget": "checkbox",
          "options": ["movimiento", "respiración", "comida", "esfuerzo", "estrés"],
          "required": false
        }
      ]
    },
    {
      "id": "sintomasAsociados",
      "title": "Síntomas asociados (por sistemas)",
      "fields": [
        {
          "id": "sintomas_generales",
          "label": "Generales: fiebre / escalofríos / astenia / pérdida de peso / sudoración nocturna",
          "type": "multi",
          "widget": "checkbox",
          "options": ["fiebre", "escalofrios", "astenia", "perdida_peso", "sudoracion_nocturna"],
          "required": false
        },
        {
          "id": "sintomas_cardiovascular",
          "label": "Cardiovascular: palpitaciones / dolor torácico / disnea / edemas piernas / ninguno",
          "type": "multi",
          "widget": "checkbox",
          "options": ["palpitaciones", "dolor_toracico", "disnea", "edemas_piernas", "ninguno"],
          "required": false
        },
        {
          "id": "sintomas_respiratorio",
          "label": "Respiratorio: tos / expectoración / disnea / dolor torácico con la respiración",
          "type": "multi",
          "widget": "checkbox",
          "options": ["tos", "expectoracion", "disnea", "dolor_toracico_respiratorio"],
          "required": false
        },
        {
          "id": "sintomas_digestivo",
          "label": "Digestivo: náuseas / vómitos / diarrea / constipación / dolor abdominal",
          "type": "multi",
          "widget": "checkbox",
          "options": ["nauseas", "vomitos", "diarrea", "constipacion", "dolor_abdominal"],
          "required": false
        },
        {
          "id": "sintomas_urinario",
          "label": "Urinario: disuria / polaquiuria / hematuria / cambios color orina / sin cambios",
          "type": "multi",
          "widget": "checkbox",
          "options": ["disuria", "polaquiuria", "hematuria", "cambios_color_urina", "sin_cambios"],
          "required": false
        },
        {
          "id": "sintomas_neurologico",
          "label": "Neurológico: cefalea / mareos / vértigo / alteraciones visuales / parestesias",
          "type": "multi",
          "widget": "checkbox",
          "options": ["cefalea", "mareos", "vertigo", "alteraciones_visuales", "parestesias"],
          "required": false
        },
        {
          "id": "sintomas_otros_detalle",
          "label": "Otros (especificar según motivo)",
          "type": "text",
          "widget": "textarea",
          "required": false
        }
      ]
    },
    {
      "id": "factoresDesencadenantes",
      "title": "Factores desencadenantes y contexto",
      "fields": [
        {
          "id": "factores_desencadenantes",
          "label": "¿Hubo algún factor que precipitó los síntomas?",
          "type": "multi",
          "widget": "checkbox",
          "options": ["traumatismo", "ejercicio", "alimento_especifico", "medicamento_nuevo", "estres_emocional", "exposicion_ambiental", "picadura_insecto", "otro"],
          "required": false
        },
        {
          "id": "factores_actividad_relacionada",
          "label": "¿Se relaciona con alguna actividad específica? Si no, cuál",
          "type": "text",
          "widget": "text",
          "required": false
        },
        {
          "id": "factores_varia_momento_dia",
          "label": "¿Varía con el momento del día? Si no, cuál",
          "type": "text",
          "widget": "text",
          "required": false
        },
        {
          "id": "factores_varia_comidas",
          "label": "¿Varía con las comidas? Si no, cuál",
          "type": "text",
          "widget": "text",
          "required": false
        }
      ]
    },
    {
      "id": "antecedentesRecientes",
      "title": "Antecedentes recientes y contactos",
      "fields": [
        {
          "id": "antecedentes_contactos_similares",
          "label": "¿Alguien cercano presentó síntomas similares?",
          "type": "boolean",
          "widget": "toggle",
          "required": false
        },
        {
          "id": "antecedentes_contactos_detalle",
          "label": "Si sí, quién / contexto",
          "type": "text",
          "widget": "text",
          "required": false,
          "visibleIf": { "antecedentes_contactos_similares": true }
        },
        {
          "id": "antecedentes_previos",
          "label": "¿Ha tenido cuadros parecidos antes? ¿Cuándo? ¿Cómo se resolvieron?",
          "type": "text",
          "widget": "textarea",
          "required": false
        },
        {
          "id": "antecedentes_infecciones_recientes",
          "label": "¿Tuvo infecciones recientes? (respiratoria / urinaria / gastrointestinal)",
          "type": "multi",
          "widget": "checkbox",
          "options": ["respiratoria", "urinaria", "gastrointestinal", "ninguna"],
          "required": false
        },
        {
          "id": "antecedentes_viajes_destino",
          "label": "¿Ha viajado recientemente? ¿A dónde?",
          "type": "text",
          "widget": "text",
          "required": false
        },
        {
          "id": "antecedentes_exposicion_mosquitos",
          "label": "¿Exposición a mosquitos?",
          "type": "boolean",
          "widget": "toggle",
          "required": false
        },
        {
          "id": "antecedentes_contacto_animales",
          "label": "¿Contacto con animales (rural/ganado)?",
          "type": "boolean",
          "widget": "toggle",
          "required": false
        },
        {
          "id": "antecedentes_contacto_animales_detalle",
          "label": "Si sí, especificar",
          "type": "text",
          "widget": "text",
          "required": false,
          "visibleIf": { "antecedentes_contacto_animales": true }
        }
      ]
    },
    {
      "id": "repercusiones",
      "title": "Repercusión funcional y calidad de vida",
      "fields": [
        {
          "id": "repercusiones_actividades",
          "label": "¿Le impide realizar sus actividades habituales?",
          "type": "boolean",
          "widget": "toggle",
          "required": false
        },
        {
          "id": "repercusiones_ausencia_trabajo",
          "label": "¿Tuvo que quedarse en cama o faltar al trabajo/estudio?",
          "type": "boolean",
          "widget": "toggle",
          "required": false
        },
        {
          "id": "repercusiones_sueno",
          "label": "¿Ha afectado su sueño?",
          "type": "boolean",
          "widget": "toggle",
          "required": false
        },
        {
          "id": "repercusiones_apetito",
          "label": "¿Ha afectado su apetito?",
          "type": "boolean",
          "widget": "toggle",
          "required": false
        },
        {
          "id": "repercusiones_estado_animo",
          "label": "¿Ha afectado su estado de ánimo?",
          "type": "boolean",
          "widget": "toggle",
          "required": false
        }
      ]
    },
    {
      "id": "tratamientosPrevios",
      "title": "Tratamientos previos y automedicación",
      "fields": [
        {
          "id": "tratamientos_previos_medicacion",
          "label": "¿Tomó alguna medicación para aliviarlo? ¿Cuál? ¿Dosis?",
          "type": "text",
          "widget": "textarea",
          "required": false
        },
        {
          "id": "tratamientos_previos_resultado",
          "label": "¿Le hizo efecto? ¿Cuánto tiempo después?",
          "type": "text",
          "widget": "text",
          "required": false
        },
        {
          "id": "tratamientos_previos_atencion_previa",
          "label": "¿Recibió atención médica antes de esta consulta? ¿Dónde?",
          "type": "text",
          "widget": "text",
          "required": false
        },
        {
          "id": "tratamientos_previos_estudios",
          "label": "¿Le indicaron estudios? ¿Tiene los resultados?",
          "type": "text",
          "widget": "text",
          "required": false
        },
        {
          "id": "tratamientos_previos_remedios_caseros",
          "label": "¿Usa remedios caseros o medicina alternativa?",
          "type": "text",
          "widget": "text",
          "required": false
        }
      ]
    },
    {
      "id": "redFlags",
      "title": "Síntomas de alarma (Red Flags)",
      "fields": [
        {
          "id": "redflags_fiebre_dias",
          "label": "Fiebre alta persistente (>38.5°C) - días de fiebre",
          "type": "number",
          "widget": "number",
          "required": false
        },
        {
          "id": "redflags_sangrados",
          "label": "Sangrados (hemoptisis, hematemesis, melena, hematuria, otro)",
          "type": "multi",
          "widget": "checkbox",
          "options": ["hemoptisis", "hematemesis", "melena", "hematuria", "otro"],
          "required": false
        },
        {
          "id": "redflags_disnea_severa",
          "label": "Dificultad respiratoria severa o disnea de reposo",
          "type": "boolean",
          "widget": "toggle",
          "required": false
        },
        {
          "id": "redflags_dolor_toracico",
          "label": "Dolor torácico intenso / opresivo",
          "type": "boolean",
          "widget": "toggle",
          "required": false
        },
        {
          "id": "redflags_dolor_toracico_irradia",
          "label": "Si dolor torácico, irradiación (describir)",
          "type": "text",
          "widget": "text",
          "required": false,
          "visibleIf": { "redflags_dolor_toracico": true }
        },
        {
          "id": "redflags_perdida_peso",
          "label": "Pérdida de peso no intencional significativa (>5% en 1 mes)",
          "type": "boolean",
          "widget": "toggle",
          "required": false
        },
        {
          "id": "redflags_sincope",
          "label": "Pérdida de conciencia / síncope / lipotimia",
          "type": "boolean",
          "widget": "toggle",
          "required": false
        },
        {
          "id": "redflags_convulsiones",
          "label": "Convulsiones",
          "type": "boolean",
          "widget": "toggle",
          "required": false
        },
        {
          "id": "redflags_neurologico",
          "label": "Alteraciones neurológicas agudas (paresia, parestesias, afasia, alteración visual súbita)",
          "type": "multi",
          "widget": "checkbox",
          "options": ["paresia", "parestesias", "afasia", "alteracion_visual_sud"],
          "required": false
        },
        {
          "id": "redflags_deshidratacion",
          "label": "Deshidratación severa (contexto vómitos/diarrea) - detalles",
          "type": "text",
          "widget": "text",
          "required": false
        },
        {
          "id": "redflags_ictericia",
          "label": "Ictericia (piel/ojos amarillos)",
          "type": "boolean",
          "widget": "toggle",
          "required": false
        },
        {
          "id": "redflags_petequias",
          "label": "Signos de sangrado activo o petequias",
          "type": "boolean",
          "widget": "toggle",
          "required": false
        }
      ]
    },
      ]
    }
  ]
}

Notas rápidas:

Cada campo aquí tiene id (se usa como key), label, y type que el backend espera: text, date, single, multi, boolean, number.
widget, options, hint y visibleIf son orientación para el frontend; no son interpretados por el backend.
Cuando el frontend envíe respuestas, convertir cada campo a { "key": "<id>", "type": "<type>", "value": <valor> } y agrupar en answers junto con patientID.

Ejemplos que le pase a fer:
fer, asi vas a recibir la data:
{
  "pasoActual": "resumen",
  "partialState": {
    "motivo_consulta": "dolor testicular",
    "edad": 20,
    "genero": "mujer",
    "opciones": [
      {
        "label": "ITS previas",
        "checked": true
      },
      {
        "label": "Alergia a sulfamidas",
        "checked": true
      },
      {
        "label": "Ibuprofeno 400-600 mg cada 6-8 horas",
        "checked": true
      }
    ],
    "inicioCuadro_fecha_inicio": "2025-10-14",
    "inicioCuadro_tipo_inicio": "súbito",
    "inicioCuadro_descripcion": "Comienzo brusco de dolor intenso en ano",
    "inicioCuadro_gesto_desencadena": "Defecación con esfuerzo",
    "evolucion_como": "progresivo",
    "evolucion_remision": "intermitente",
    "evolucion_remision_detalle": "Periodos de alivio de 2-3 días cada semana",
    "evolucion_patron_horario": "nocturno",
    "evolucion_tratamiento_recibido": true,
    "evolucion_tratamiento_detalle": "Ibuprofeno 400 mg, mejoría parcial después de 48 h",
    "evolucion_tratamiento_resultado": "mejoró",
    "evolucion_frecuencia": "Episodios diarios, 2-3 veces al día",
    "evolucion_hace_cuanto": "3 días",
    "localizacion_principal": "Ano y región perianal",
    "localizacion_irradia": true,
    "localizacion_irradia_hacia": "",
    "caracteristicas_tipo": "punzante",
    "caracteristicas_intensidad": 7,
    "caracteristicas_duracion_crisis": "30-60 minutos",
    "caracteristicas_factores_mejoran": "Reposo y baños de asiento",
    "caracteristicas_factores_empeoran": "Defecación y esfuerzo",
    "sintomasAsociados_sangrado": true,
    "sintomasAsociados_sangrado_cantidad": "Pérdidas pequeñas tras la defecación",
    "sintomasAsociados_fiebre": true,
    "sintomasAsociados_secreciones": true,
    "sintomasAsociados_alteraciones_defecacion": "Estreñimiento crónico",
    "factoresDesencadenantes_alimentos": [
      "picantes",
      "grasas"
    ],
    "factoresDesencadenantes_esfuerzo": true,
    "factoresDesencadenantes_actividad_relacionada": "Defecar tras comidas copiosas",
    "antecedentesRecientes_infecciones": "Oxiuriasis hace 6 meses",
    "antecedentesRecientes_traumatismos": "Pequeño trauma perianal tras caída",
    "antecedentesRecientes_intervenciones": "Sin cirugías recientes",
    "repercusiones_actividad": "Dificultad para jugar, llanto al defecar",
    "repercusiones_sueño": "Interrumpe el sueño nocturno",
    "repercusiones_alimentacion": "Disminución del apetito",
    "tratamientosPrevios_medicacion_actual": [
      "ibuprofeno 400 mg"
    ],
    "tratamientosPrevios_medicacion_anterior": "Antibióticos tópicos sin receta",
    "tratamientosPrevios_intervenciones": "Ninguna",
    "tratamientosPrevios_resultado": "Mejoría parcial con AINEs",
    "sintomasAlarma_fiebre_alta": true,
    "sintomasAlarma_sangrado_abundante": true,
    "sintomasAlarma_cambios_neurologicos": true,
    "sintomasAlarma_persistencia": true
  }
}


inicioCuadro
{
"patientID": "AECF-PLACEHOLDER-ID",
"answers": [
{ "key": "inicioCuadro_fecha_inicio", "type": "date", "value": null },
{ "key": "inicioCuadro_tipo_inicio", "type": "single", "value": null },
{ "key": "inicioCuadro_descripcion", "type": "text", "value": null },
{ "key": "inicioCuadro_gesto_desencadena", "type": "text", "value": null }
]
}

evolucion
{
"patientID": "AECF-PLACEHOLDER-ID",
"answers": [
{ "key": "evolucion_como", "type": "single", "value": null },
{ "key": "evolucion_remision", "type": "single", "value": null },
{ "key": "evolucion_remision_detalle", "type": "text", "value": null },
{ "key": "evolucion_patron_horario", "type": "single", "value": null },
{ "key": "evolucion_tratamiento_recibido", "type": "boolean", "value": null },
{ "key": "evolucion_tratamiento_detalle", "type": "text", "value": null },
{ "key": "evolucion_tratamiento_resultado", "type": "single", "value": null },
{ "key": "evolucion_frecuencia", "type": "text", "value": null },
{ "key": "evolucion_hace_cuanto", "type": "text", "value": null }
]
}

localizacion
{
"patientID": "AECF-PLACEHOLDER-ID",
"answers": [
{ "key": "localizacion_principal", "type": "text", "value": null },
{ "key": "localizacion_irradia", "type": "boolean", "value": null },
{ "key": "localizacion_irradia_hacia", "type": "text", "value": null }
]
}


caracteristicas
{
"patientID": "AECF-PLACEHOLDER-ID",
"answers": [
{ "key": "caracteristicas_tipo", "type": "single", "value": null },
{ "key": "caracteristicas_intensidad", "type": "number", "value": null },
{ "key": "caracteristicas_duracion_crisis", "type": "text", "value": null },
{ "key": "caracteristicas_factores_mejoran", "type": "text", "value": null },
{ "key": "caracteristicas_factores_empeoran", "type": "text", "value": null }
]
}

sintomasAsociados
{
"patientID": "AECF-PLACEHOLDER-ID",
"answers": [
{ "key": "sintomasAsociados_sangrado", "type": "boolean", "value": null },
{ "key": "sintomasAsociados_sangrado_cantidad", "type": "text", "value": null },
{ "key": "sintomasAsociados_fiebre", "type": "boolean", "value": null },
{ "key": "sintomasAsociados_secreciones", "type": "boolean", "value": null },
{ "key": "sintomasAsociados_alteraciones_defecacion", "type": "text", "value": null }
]
}


factoresDesencadenantes
{
"patientID": "AECF-PLACEHOLDER-ID",
"answers": [
{ "key": "factoresDesencadenantes_alimentos", "type": "multi", "value": [] },
{ "key": "factoresDesencadenantes_esfuerzo", "type": "boolean", "value": null },
{ "key": "factoresDesencadenantes_actividad_relacionada", "type": "text", "value": null }
]
}


antecedentesRecientes
{
"patientID": "AECF-PLACEHOLDER-ID",
"answers": [
{ "key": "antecedentesRecientes_infecciones", "type": "text", "value": null },
{ "key": "antecedentesRecientes_traumatismos", "type": "text", "value": null },
{ "key": "antecedentesRecientes_intervenciones", "type": "text", "value": null }
]
}


repercusiones
{
"patientID": "AECF-PLACEHOLDER-ID",
"answers": [
{ "key": "repercusiones_actividad", "type": "text", "value": null },
{ "key": "repercusiones_sueño", "type": "text", "value": null },
{ "key": "repercusiones_alimentacion", "type": "text", "value": null }
]
}

tratamientosPrevios
{
"patientID": "AECF-PLACEHOLDER-ID",
"answers": [
{ "key": "tratamientosPrevios_medicacion_actual", "type": "multi", "value": [] },
{ "key": "tratamientosPrevios_medicacion_anterior", "type": "text", "value": null },
{ "key": "tratamientosPrevios_intervenciones", "type": "text", "value": null },
{ "key": "tratamientosPrevios_resultado", "type": "text", "value": null }
]
}


sintomasAlarma
{
"patientID": "AECF-PLACEHOLDER-ID",
"answers": [
{ "key": "sintomasAlarma_fiebre_alta", "type": "boolean", "value": null },
{ "key": "sintomasAlarma_sangrado_abundante", "type": "boolean", "value": null },
{ "key": "sintomasAlarma_cambios_neurologicos", "type": "boolean", "value": null },
{ "key": "sintomasAlarma_persistencia", "type": "boolean", "value": null }
]
}


resumen
{
"patientID": "AECF-PLACEHOLDER-ID",
"answers": [
{ "key": "resumen_resumenLibre", "type": "text", "value": null },
{ "key": "resumen_pendientes", "type": "multi", "value": [] },
{ "key": "resumen_prioridades", "type": "multi", "value": [] }
]
}




